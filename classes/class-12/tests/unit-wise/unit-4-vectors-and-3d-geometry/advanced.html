<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit 4 Test: Vectors & 3D Geometry (Advanced) | Class 12 Maths</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Shared Test CSS -->
    <link rel="stylesheet" href="../../../../../assets/css/test-interface.css">
    
    <!-- MathJax -->
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        @media (max-width: 768px) {
            #paletteToggle { display: block !important; }
            .nav-panel.collapsed #paletteBody { display: none; }
            .nav-panel.collapsed #paletteToggle i { transform: rotate(180deg); }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="test-header">
        <div class="logo" style="font-weight: 800; color: var(--test-primary); font-size: 1.2rem;">
            &int; SJMaths <span style="color:#666; font-weight:400;">| Unit 4 Test (Advanced)</span>
        </div>
        <div class="timer-badge">
            <i class="far fa-clock"></i> <span id="timerDisplay">60:00</span>
        </div>
        <button class="btn-exit" onclick="if(confirm('Quit test?')) window.location.href='../../index.html'">
            Exit
        </button>
    </header>

    <!-- Main Layout -->
    <div class="test-container">
        
        <!-- Left: Question Area -->
        <main class="question-panel">
            <div class="section-header" id="qSection">Section A</div>
            
            <div class="q-header">
                <span id="qNumber">Question 1</span>
                <span id="qMarks">(1 Mark)</span>
            </div>

            <div class="q-text" id="qText">
                <!-- Question Content -->
            </div>

            <div id="inputArea">
                <!-- Options or Textarea -->
            </div>

            <div id="solutionArea" class="solution-div">
                <!-- Solution shown after submit -->
            </div>
        </main>

        <!-- Right: Navigation -->
        <aside class="nav-panel">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                <h3 style="margin:0; font-size:1rem;">Question Palette</h3>
                <button id="paletteToggle" style="background:none; border:none; color:var(--test-primary, #2c3e50); cursor:pointer; display:none; font-size:1.1rem;">
                    <i class="fas fa-chevron-up" style="transition: transform 0.3s;"></i>
                </button>
            </div>
            
            <div id="paletteBody">
                <div class="palette-grid" id="questionPalette">
                    <!-- Buttons generated by JS -->
                </div>
                
                <div style="margin-top: 2rem; font-size: 0.8rem; color: #666;">
                    <div style="display:flex; gap:8px; align-items:center; margin-bottom:5px;">
                        <span style="width:12px; height:12px; background:#27ae60; border-radius:50%;"></span> Answered
                    </div>
                    <div style="display:flex; gap:8px; align-items:center; margin-bottom:5px;">
                        <span style="width:12px; height:12px; background:#c0392b; border-radius:50%;"></span> Visited
                    </div>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <span style="width:12px; height:12px; border:1px solid #ccc; border-radius:50%;"></span> Not Visited
                    </div>
                </div>
            </div>
        </aside>

    </div>

    <!-- Footer -->
    <footer class="test-footer">
        <button class="btn-nav btn-prev" id="btnPrev">Previous</button>
        <button class="btn-nav btn-next" id="btnNext">Next</button>
    </footer>

    <!-- Result Modal -->
    <div class="result-overlay" id="resultModal">
        <div class="result-card">
            <div class="score-circle">
                <div class="score-text"></div>
            </div>
            <div id="resultMessage"></div>
            <button class="btn-nav btn-submit" onclick="closeResult()" style="margin-top:1.5rem;">Review Answers</button>
            <a href="../../index.html" style="display:block; margin-top:1rem; color:#666; text-decoration:none;">Back to Dashboard</a>
        </div>
    </div>

    <!-- Test Engine Script -->
    <script src="../../../../../assets/js/test-engine.js"></script>
    <script src="../../../../../assets/js/test-dark-mode.js"></script>
    
    <!-- Test Data Configuration -->
    <script>
        const testConfig = {
            timeLimit: 60, // 1 Hour
            exitUrl: '../../index.html',
            questions: [
                // --- Section A: MCQs (1 Mark) ---
                { id: 1, type: 'mcq', section: 'Section A', marks: 1, question: "If $|\vec{a} + \vec{b}| = 60$, $|\vec{a} - \vec{b}| = 40$ and $|\vec{b}| = 46$, then $|\vec{a}|$ is", options: ["22", "21", "11", "32"], finalAnswer: "(a) 22", solutionSteps: ["$|\vec{a}+\vec{b}|^2 + |\vec{a}-\vec{b}|^2 = 2(|\vec{a}|^2 + |\vec{b}|^2)$.", "$3600 + 1600 = 2(|\vec{a}|^2 + 2116)$.", "$5200 = 2|\vec{a}|^2 + 4232 \\implies 2|\vec{a}|^2 = 968 \\implies |\vec{a}|^2 = 484 \\implies |\vec{a}| = 22$."] },
                { id: 2, type: 'mcq', section: 'Section A', marks: 1, question: "The angle between the lines whose direction cosines satisfy $l+m+n=0$ and $l^2+m^2-n^2=0$ is", options: ["$\\pi/6$", "$\\pi/4$", "$\\pi/3$", "$\\pi/2$"], finalAnswer: "(c) $\\pi/3$", solutionSteps: ["$n = -(l+m)$. Substitute in $l^2+m^2-n^2=0$.", "$l^2+m^2-(l+m)^2=0 \\implies -2lm=0 \\implies l=0$ or $m=0$.", "If $l=0, n=-m$. DRs $(0, 1, -1)$. If $m=0, n=-l$. DRs $(1, 0, -1)$.", "$\cos\\theta = \frac{0+0+1}{\sqrt{2}\sqrt{2}} = \frac{1}{2} \implies \theta = \pi/3$."] },
                { id: 3, type: 'mcq', section: 'Section A', marks: 1, question: "If $\vec{a}, \vec{b}, \vec{c}$ are unit vectors such that $\vec{a} + \vec{b} + \vec{c} = \vec{0}$, then the value of $\vec{a} \cdot \vec{b} + \vec{b} \cdot \vec{c} + \vec{c} \cdot \vec{a}$ is", options: ["1", "3", "-3/2", "3/2"], finalAnswer: "(c) -3/2", solutionSteps: ["$|\vec{a}+\vec{b}+\vec{c}|^2 = 0$.", "$\sum |\vec{a}|^2 + 2(\sum \vec{a} \cdot \vec{b}) = 0$.", "$3 + 2K = 0 \implies K = -3/2$."] },
                { id: 4, type: 'mcq', section: 'Section A', marks: 1, question: "The distance of the point $(1, 2, 3)$ from the line $\vec{r} = 6\hat{i} + 7\hat{j} + 7\hat{k} + \lambda(3\hat{i} + 2\hat{j} - 2\hat{k})$ is", options: ["5", "7", "6", "4"], finalAnswer: "(b) 7", solutionSteps: ["General point $Q(3\lambda+6, 2\lambda+7, -2\lambda+7)$.", "$\vec{PQ} = (3\lambda+5, 2\lambda+5, -2\lambda+4)$.", "$\vec{PQ} \cdot (3, 2, -2) = 0 \implies 9\lambda+15+4\lambda+10+4\lambda-8=0 \implies 17\lambda+17=0 \implies \lambda=-1$.", "$Q(3, 5, 9)$. Distance $PQ = \sqrt{4+9+36} = 7$."] },
                { id: 5, type: 'mcq', section: 'Section A', marks: 1, question: "The projection of the vector $\\vec{a} = 2\\hat{i} - \\hat{j} + \\hat{k}$ on the vector $\\vec{b} = \\hat{i} + 2\\hat{j} + 2\\hat{k}$ is", options: ["1/3", "2/3", "4/3", "5/3"], finalAnswer: "(b) 2/3", solutionSteps: ["Projection = $\\frac{\\vec{a} \\cdot \\vec{b}}{|\\vec{b}|}$.", "$\\vec{a} \\cdot \\vec{b} = 2(1) - 1(2) + 1(2) = 2$.", "$|\\vec{b}| = \\sqrt{1+4+4} = 3$.", "Projection = $2/3$."] },

                // --- Section B: Subjective (2 Marks) ---
                { id: 6, type: 'subjective', section: 'Section B', marks: 2, question: "Find a unit vector perpendicular to the plane of triangle ABC where $A(3, -1, 2)$, $B(1, -1, -3)$ and $C(4, -3, 1)$.", finalAnswer: "$\pm \frac{1}{\sqrt{165}}(10\hat{i} + 7\hat{j} + 4\hat{k})$", solutionSteps: ["$\vec{AB} = -2\hat{i} - 5\hat{k}$, $\vec{AC} = \hat{i} - 2\hat{j} - \hat{k}$.", "$\vec{n} = \vec{AB} \times \vec{AC} = \begin{vmatrix} \hat{i} & \hat{j} & \hat{k} \\ -2 & 0 & -5 \\ 1 & -2 & -1 \end{vmatrix} = -10\hat{i} - 7\hat{j} + 4\hat{k}$.", "Unit vector = $\frac{-10\hat{i}-7\hat{j}+4\hat{k}}{\sqrt{100+49+16}}$."] },
                { id: 7, type: 'subjective', section: 'Section B', marks: 2, question: "If $\vec{a} = \hat{i} + \hat{j} + \hat{k}$ and $\vec{b} = \hat{j} - \hat{k}$, find a vector $\vec{c}$ such that $\vec{a} \times \vec{c} = \vec{b}$ and $\vec{a} \cdot \vec{c} = 3$.", finalAnswer: "$\vec{c} = \frac{5}{3}\hat{i} + \frac{2}{3}\hat{j} + \frac{2}{3}\hat{k}$", solutionSteps: ["Let $\vec{c} = x\hat{i} + y\hat{j} + z\hat{k}$.", "$\vec{a} \cdot \vec{c} = x+y+z=3$.", "$\vec{a} \times \vec{c} = (z-y)\hat{i} + (x-z)\hat{j} + (y-x)\hat{k} = \hat{j} - \hat{k}$.", "$z-y=0 \implies y=z$. $x-z=1 \implies x=z+1$. $y-x=-1$.", "Substitute in dot product: $(z+1) + z + z = 3 \implies 3z=2 \implies z=2/3$.", "$y=2/3, x=5/3$."] },
                { id: 8, type: 'subjective', section: 'Section B', marks: 2, question: "Find the Cartesian equation of the line which passes through the point $(-2, 4, -5)$ and parallel to the line given by $\frac{x+3}{3} = \frac{y-4}{5} = \frac{z+8}{6}$.", finalAnswer: "$\frac{x+2}{3} = \frac{y-4}{5} = \frac{z+5}{6}$", solutionSteps: ["Parallel lines have same direction ratios: 3, 5, 6.", "Point $(-2, 4, -5)$.", "Equation: $\frac{x+2}{3} = \frac{y-4}{5} = \frac{z+5}{6}$."] },

                // --- Section C: Subjective (3 Marks) ---
                { id: 9, type: 'subjective', section: 'Section C', marks: 3, question: "Find the image of the point $P(1, 6, 3)$ in the line $\frac{x}{1} = \frac{y-1}{2} = \frac{z-2}{3}$.", finalAnswer: "$(1, 0, 7)$", solutionSteps: ["General point $M(\lambda, 2\lambda+1, 3\lambda+2)$.", "$\vec{PM} = (\lambda-1, 2\lambda-5, 3\lambda-1)$.", "$\vec{PM} \perp \vec{d} \implies 1(\lambda-1) + 2(2\lambda-5) + 3(3\lambda-1) = 0$.", "$14\lambda - 14 = 0 \implies \lambda = 1$. Foot $M(1, 3, 5)$.", "Image $P'(x,y,z)$. Midpoint is M. $\frac{1+x}{2}=1 \implies x=1$. $\frac{6+y}{2}=3 \implies y=0$. $\frac{3+z}{2}=5 \implies z=7$."] },
                { id: 10, type: 'subjective', section: 'Section C', marks: 3, question: "If $\vec{a}, \vec{b}, \vec{c}$ are three vectors such that $|\vec{a}|=3, |\vec{b}|=4, |\vec{c}|=5$ and each one of them is perpendicular to the sum of the other two, find $|\vec{a}+\vec{b}+\vec{c}|$.", finalAnswer: "$5\sqrt{2}$", solutionSteps: ["$\vec{a} \cdot (\vec{b}+\vec{c}) = 0 \implies \vec{a}\cdot\vec{b} + \vec{a}\cdot\vec{c} = 0$.", "Similarly $\vec{b}\cdot\vec{a} + \vec{b}\cdot\vec{c} = 0$ and $\vec{c}\cdot\vec{a} + \vec{c}\cdot\vec{b} = 0$.", "Adding: $2(\vec{a}\cdot\vec{b} + \vec{b}\cdot\vec{c} + \vec{c}\cdot\vec{a}) = 0$.", "$|\vec{a}+\vec{b}+\vec{c}|^2 = 9+16+25+0 = 50$.", "Magnitude is $5\sqrt{2}$."] },
                { id: 11, type: 'subjective', section: 'Section C', marks: 3, question: "Find the shortest distance between the lines $\vec{r} = (6\hat{i} + 2\hat{j} + 2\hat{k}) + \lambda(\hat{i} - 2\hat{j} + 2\hat{k})$ and $\vec{r} = (-4\hat{i} - \hat{k}) + \mu(3\hat{i} - 2\hat{j} - 2\hat{k})$.", finalAnswer: "9 units", solutionSteps: ["$\vec{a_1} = (6,2,2), \vec{a_2} = (-4,0,-1)$. $\vec{a_2}-\vec{a_1} = (-10, -2, -3)$.", "$\vec{b_1} = (1,-2,2), \vec{b_2} = (3,-2,-2)$.", "$\vec{b_1} \times \vec{b_2} = 8\hat{i} + 8\hat{j} + 4\hat{k}$. Magnitude = 12.", "Dot product: $-10(8) + (-2)(8) + (-3)(4) = -80 - 16 - 12 = -108$.", "Distance = $|-108|/12 = 9$."] },

                // --- Section D: Long Answer (5 Marks) ---
                { id: 12, type: 'subjective', section: 'Section D', marks: 5, question: "Find the coordinates of the foot of the perpendicular drawn from the point $A(1, 8, 4)$ to the line joining the points $B(0, -1, 3)$ and $C(2, -3, -1)$. Also find the image of the point A in this line.", finalAnswer: "Foot: $(-5/3, 2/3, 19/3)$, Image: $(-13/3, -20/3, 26/3)$", solutionSteps: ["Line BC: $\vec{r} = -\hat{j} + 3\hat{k} + \lambda(2\hat{i} - 2\hat{j} - 4\hat{k})$.", "General point $F(2\lambda, -2\lambda-1, -4\lambda+3)$.", "$\vec{AF} = (2\lambda-1, -2\lambda-9, -4\lambda-1)$.", "$\vec{AF} \cdot (2, -2, -4) = 0 \implies 2(2\lambda-1) - 2(-2\lambda-9) - 4(-4\lambda-1) = 0$.", "$4\lambda-2 + 4\lambda+18 + 16\lambda+4 = 0 \implies 24\lambda + 20 = 0 \implies \lambda = -5/6$.", "Substitute $\lambda$ to find Foot F.", "Use midpoint formula for Image $A'$: $F = (A+A')/2$."] }
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            new TestEngine(testConfig);

            // Mobile Palette Toggle
            const toggleBtn = document.getElementById('paletteToggle');
            const navPanel = document.querySelector('.nav-panel');
            
            if(toggleBtn && navPanel) {
                toggleBtn.addEventListener('click', () => {
                    navPanel.classList.toggle('collapsed');
                });
            }
        });
    </script>
</body>
</html>